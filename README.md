> [!WARNING]
> This theme should not considered stable at this point in time.

# ii-sddm-theme

## Introduction

[ii-sddm-theme](https://github.com/3d3f/ii-sddm-theme) is a custom theme for the [SDDM](https://github.com/sddm/sddm/) display manager, heavily inspired by the lockscreen aesthetic of [illogical impulse](https://github.com/end-4/dots-hyprland). 

This project was developed out of a personal desire to unify the login manager's appearance with the overall shell experience, particularly for Hyprland users on Arch/Arch-based distributions who use ii dotfiles. 

I'm not a developer and this theme is not the work of someone with good coding skills, i only have a really basic knowledge of Qt Qml documentation.
This theme was tested only on my configuration.

Please note that this project is an independent creation and is not affiliated with, nor maintained by, the original `illogical impulse` developers.

## Sources and Acknowledgements

This theme leverages code and inspiration from several excellent projects. My gratitude to the contributors of:

*   [Keyitdev/sddm-astronaut-theme](https://github.com/Keyitdev/sddm-astronaut-theme): The base code structure of the theme
*   [illogical impulse](https://github.com/end-4/dots-hyprland): The primary aesthetic inspiration for this theme and the source of the code i tried to import for the widgets
*   [SilentSDDM](https://github.com/uiriansan/SilentSDDM): Referenced for various code implementations, mainly the virtual keyboard management
*   [qt/qtvirtualkeyboard](https://github.com/qt/qtvirtualkeyboard): Utilized for virtual keyboard functionalities

---

# Preview

<p align="center">
  <img src="https://github.com/3d3f/ii-sddm-theme/raw/main/Previews/preview1.png" width="48%" alt="Preview 1" />
  <img src="https://github.com/3d3f/ii-sddm-theme/raw/main/Previews/preview2.png" width="48%" alt="Preview 2" />
</p>

## Installation
[`Install script`](#Install-script) 
[`Manual installation`](#Manual-installation)

### Install script
> [!IMPORTANT]
> Consider this script a WIP and in testing, read it through before running it, or procede to manual installation

This script can prompt you to three different types of installation
- ii + Matugen Integration (my settings, wallpapers and colors will be generated by my ii settings app preferences)
- Matugen Integration Only (i will use matugen to generate colors from a wallpaper and manually edit my settings)
- No Matugen Integration (i will manually choose my background and manually edit my color scheme and settings)


```sh
sh -c "$(curl -fsSL https://raw.githubusercontent.com/3d3f/ii-sddm-theme/main/setup.sh)"
```
> Only Arch with Hyprland supported.
> Note that different from expected folder structure will require you to manual install the theme.

> [!IMPORTANT]
> Make sure to test the theme before rebooting by running 
```bash
sddm-greeter-qt6 --test-mode --theme /usr/share/sddm/themes/ii-sddm-theme/
```
otherwise you might end up with a broken login screen.
> Test appearance is not exactly representative of how the theme will look, if something goes wrong [open an issue](https://github.com/uiriansan/SilentSDDM/issues/new/choose).

### Manual installation

This section guides you through the manual installation process. There are three different approaches depending on whether you want to integrate with `illogical impulse` settings, `matugen` for dynamic color schemes, or neither. **Choose ONE of the following three options to proceed after completing steps 1-3.**

#### 1. Install **dependencies**

**Arch Linux**
```bash
yay -S --needed sddm qt6-svg qt6-virtualkeyboard qt6-multimedia-ffmpeg otf-space-grotesk ttf-gabarito-git ttf-material-symbols-variable-git ttf-readex-pro ttf-rubik-vf
```

#### 2. Clone this repo:
```bash
git clone -b main --depth=1 https://github.com/3d3f/ii-sddm-theme
cd ii-sddm-theme/
```

#### 3. Test the theme to make sure you have all dependencies:
```bash
./test.sh
```
> [!IMPORTANT]
> Test appearance is not exactly representative of how the theme will look, if something goes wrong [open an issue](https://github.com/uiriansan/SilentSDDM/issues/new/choose).

---

### Choose your installation type:

You must choose one of the following methods to continue the manual installation. Each method provides different levels of integration and customization.

<details>
  <summary>ii + Matugen Integration (my settings, wallpapers and colors will be generated by my ii settings app preferences)</summary>

  This option is for users who have `illogical impulse` and `matugen` configured and want the SDDM theme to automatically match their Hyprland settings, wallpapers, and color schemes.

  #### 4. Copy specific integration files
  These files are essential for the theme to interact with your `illogical impulse` and `matugen` setup.
  ```bash
  mkdir -p ~/.config/hypr/custom/scripts/ii-sddm-theme/
  cp -r iiMatugen/* ~/.config/hypr/custom/scripts/ii-sddm-theme/
  chmod +x ~/.config/hypr/custom/scripts/ii-sddm-theme/sddm-theme-apply.sh
  chmod +x ~/.config/hypr/custom/scripts/ii-sddm-theme/generate_settings.py
  ```

  #### 5. Copy the theme to `/usr/share/sddm/themes/`:
  ```bash
  sudo mkdir -p /usr/share/sddm/themes/ii-sddm-theme
  sudo cp -rf . /usr/share/sddm/themes/ii-sddm-theme/
  ```

  #### 6. Replace the current theme and set the environment variables in `/etc/sddm.conf` with your favorite editor:
  ```bash
  sudo nano /etc/sddm.conf

      # Make sure these options are correct:
      [General]
      InputMethod=qtvirtualkeyboard
      GreeterEnvironment=QML2_IMPORT_PATH=/usr/share/sddm/themes/ii-sddm-theme/Components/,QT_IM_MODULE=qtvirtualkeyboard

      [Theme]
      Current=ii-sddm-theme
  ```

  #### 7. Configure `matugen` for integration:
  Ensure `matugen` is configured to output `SddmColors.qml` based on your wallpaper. You'll need to add a block to your `~/.config/matugen/config.toml` to specify how the theme should use `matugen`.

  ```toml
  # ~/.config/matugen/config.toml
  [templates.iisddmtheme]
  input_path = '~/.config/hypr/custom/scripts/ii-sddm-theme/SddmColors.qml'
  output_path = '~/.config/hypr/custom/scripts/ii-sddm-theme/Colors.qml'
  post_hook = 'python3 ~/.config/hypr/custom/scripts/ii-sddm-theme/generate_settings.py && sudo ~/.config/hypr/custom/scripts/ii-sddm-theme/sddm-theme-apply.sh &'
  ```
  This configuration ensures that `matugen` generates colors, then `generate_settings.py` updates the theme based on your `ii` settings, and finally `sddm-theme-apply.sh` applies these changes to the SDDM theme.

  #### 8. Configure `sudoers` for passwordless execution:
  To allow `sddm-theme-apply.sh` to run automatically as part of the `matugen` post-hook without asking for a password, add the following rule to a new file in `/etc/sudoers.d/` (e.g., `/etc/sudoers.d/sddm-theme-yourusername`):

  ```bash
  echo "$USER ALL=(ALL) NOPASSWD: /home/$USER/.config/hypr/custom/scripts/ii-sddm-theme/sddm-theme-apply.sh" | sudo tee /etc/sudoers.d/sddm-theme-$USER > /dev/null
  sudo chmod 0440 /etc/sudoers.d/sddm-theme-$USER
  ```
  Replace `$USER` with your actual username.

  #### 9. Apply the theme manually:
  Execute the `generate_settings.py` script and then the `sddm-theme-apply.sh` script to apply the theme with your current settings:
  ```bash
  python3 ~/.config/hypr/custom/scripts/ii-sddm-theme/generate_settings.py
  sudo ~/.config/hypr/custom/scripts/ii-sddm-theme/sddm-theme-apply.sh
  ```
  The theme should now reflect your `ii` settings.

  #### 10. Test the theme with the command:
  ```bash
  sddm-greeter-qt6 --test-mode --theme /usr/share/sddm/themes/ii-sddm-theme
  ```
  #### 11. Reboot and set a new wallpaper through the ii settings app
  #### 12. Go check the GUIDE.txt file in ~/.config/hypr/custom/scripts/ii-sddm-theme/
</details>

<details>
  <summary>Matugen Integration Only (i will use matugen to generate colors from a wallpaper and manually edit my settings)</summary>

  This option is for users who want to use `matugen` to dynamically generate color schemes from their wallpaper but do not use `illogical impulse`. You will manually manage theme settings and wallpaper.

  #### 4. Copy specific integration files
  These files are necessary for the theme to integrate with `matugen`.
  ```bash
  mkdir -p ~/.config/hypr/custom/scripts/ii-sddm-theme/
  cp -r Matugen/* ~/.config/hypr/custom/scripts/ii-sddm-theme/
  chmod +x ~/.config/hypr/custom/scripts/ii-sddm-theme/sddm-theme-apply.sh
  ```

  #### 5. Copy the theme to `/usr/share/sddm/themes/`:
  ```bash
  sudo mkdir -p /usr/share/sddm/themes/ii-sddm-theme
  sudo cp -rf . /usr/share/sddm/themes/ii-sddm-theme/
  ```

  #### 6. Replace the current theme and set the environment variables in `/etc/sddm.conf` with your favorite editor:
  ```bash
  sudo nano /etc/sddm.conf

      # Make sure these options are correct:
      [General]
      InputMethod=qtvirtualkeyboard
      GreeterEnvironment=QML2_IMPORT_PATH=/usr/share/sddm/themes/ii-sddm-theme/Components/,QT_IM_MODULE=qtvirtualkeyboard

      [Theme]
      Current=ii-sddm-theme
  ```

  #### 7. Configure `matugen` for integration:
  Add the following block to your `~/.config/matugen/config.toml` to specify how the theme should use `matugen` to generate colors.

  ```toml
  # ~/.config/matugen/config.toml
  [templates.iisddmtheme]
  input_path = '~/.config/hypr/custom/scripts/ii-sddm-theme/SddmColors.qml'
  output_path = '~/.config/hypr/custom/scripts/ii-sddm-theme/Colors.qml'
  post_hook = 'sudo ~/.config/hypr/custom/scripts/ii-sddm-theme/sddm-theme-apply.sh &'
  ```
  This configuration ensures that `matugen` generates colors, and then `sddm-theme-apply.sh` applies these changes to the SDDM theme.

  #### 8. Configure `sudoers` for passwordless execution:
  To allow `sddm-theme-apply.sh` to run automatically as part of the `matugen` post-hook without asking for a password, add the following rule to a new file in `/etc/sudoers.d/` (e.g., `/etc/sudoers.d/sddm-theme-yourusername`):

  ```bash
  echo "$USER ALL=(ALL) NOPASSWD: /home/$USER/.config/hypr/custom/scripts/ii-sddm-theme/sddm-theme-apply.sh" | sudo tee /etc/sudoers.d/sddm-theme-$USER > /dev/null
  sudo chmod 0440 /etc/sudoers.d/sddm-theme-$USER
  ```
  Replace `$USER` with your actual username.

  #### 9. Apply the theme manually:
  Run the `sddm-theme-apply.sh` script to apply the theme with your current `matugen` generated colors:
  ```bash
  sudo ~/.config/hypr/custom/scripts/ii-sddm-theme/sddm-theme-apply.sh
  ```
  #### 10. Test the theme with the command:
  ```bash
  sddm-greeter-qt6 --test-mode --theme /usr/share/sddm/themes/ii-sddm-theme
  ```
  #### 11. Reboot and go check the GUIDE.txt file in ~/.config/hypr/custom/scripts/ii-sddm-theme/
</details>

<details>
  <summary>No Matugen Integration (i will manually choose my background and manually edit my color scheme and settings)</summary>

  This option is for users who do not use `matugen` or `illogical impulse` and prefer to manually manage their background image, color scheme, and other theme settings directly.

  #### 4. Copy specific integration files
  These files are necessary for the theme to function without `matugen`.
  ```bash
  mkdir -p ~/.config/hypr/custom/scripts/ii-sddm-theme/
  cp -r noMatugen/* ~/.config/hypr/custom/scripts/ii-sddm-theme/
  chmod +x ~/.config/hypr/custom/scripts/ii-sddm-theme/sddm-theme-apply.sh
  ```

  #### 5. Copy the theme to `/usr/share/sddm/themes/`:
  ```bash
  sudo mkdir -p /usr/share/sddm/themes/ii-sddm-theme
  sudo cp -rf . /usr/share/sddm/themes/ii-sddm-theme/
  ```

  #### 6. Replace the current theme and set the environment variables in `/etc/sddm.conf` with your favorite editor:
  ```bash
  sudo nano /etc/sddm.conf

      # Make sure these options are correct:
      [General]
      InputMethod=qtvirtualkeyboard
      GreeterEnvironment=QML2_IMPORT_PATH=/usr/share/sddm/themes/ii-sddm-theme/Components/,QT_IM_MODULE=qtvirtualkeyboard

      [Theme]
      Current=ii-sddm-theme
  ```

  #### 7. Apply the theme manually:
  Run the `sddm-theme-apply.sh` script to apply the theme with its default settings or any manual changes you've made to the configuration files within the theme directory:
  ```bash
  sudo ~/.config/hypr/custom/scripts/ii-sddm-theme/sddm-theme-apply.sh
  ```
  You will be prompted for your password.

  #### 8. Test the theme with the command:
  ```bash
  sddm-greeter-qt6 --test-mode --theme /usr/share/sddm/themes/ii-sddm-theme
  ```
  #### 9. Reboot and go check the GUIDE.txt file in ~/.config/hypr/custom/scripts/ii-sddm-theme/
</details>

---

## Post install
Go to your ~/.config/hypr/custom/scripts/ii-sddm-theme folder and check the GUIDE.txt

---

## TODO in the future

> [!NOTE] Work in progress  
> The following items are on the roadmap for future improvements (maybe):

- [ ] Catch up with latest `ii` lockscreen updates
- [ ] Improve color accuracy: colors should never feel out of place, but in some cases they might not be exactly the same, this will require i actually understand how colors are generated in ii
- [ ] Improve code organization